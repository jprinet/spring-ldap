apply plugin: 'io.spring.convention.spring-test'

idea.module.excludeDirs = [
        file('.gradle'),
        file('build/classes'),
        file('build/tmp'),
        file('build/dependency-cache'),
        file('build/libs')]

sourceSets {
    generated {
        java {
            srcDirs = ['build/generated-src']
        }
    }
}

dependencies {
    implementation 	project(":spring-ldap-test"),
                project(":spring-ldap-core-tiger")

    implementation "com.querydsl:querydsl-apt",
            "commons-lang:commons-lang"

    implementation("org.springframework.data:spring-data-commons") {
        exclude group: "org.springframework", module: "spring-beans"
        exclude group: "org.springframework", module: "spring-core"
    }

    implementation("org.springframework.security:spring-security-core") {
        exclude group: "org.springframework", module: "spring-expression"
        exclude group: "org.springframework", module: "spring-core"
        exclude group: "org.springframework", module: "spring-context"
        exclude group: "org.springframework", module: "spring-tx"
        exclude group: "org.springframework", module: "spring-aop"
    }

    provided	"commons-pool:commons-pool",
                "org.springframework:spring-jdbc",
                "org.springframework:spring-orm"

    testImplementation "org.springframework:spring-test",
                "org.springframework:spring-aop",
                "org.springframework:spring-expression",
                "org.hibernate:hibernate-core",
                "aspectj:aspectjrt:1.5.4",
                "aspectj:aspectjweaver:1.5.4",
                "hsqldb:hsqldb:1.8.0.7",
                "junit:junit",
                "org.springframework.security:spring-security-config",
                "org.slf4j:slf4j-log4j12",
                "org.assertj:assertj-core"


    testImplementation("org.springframework.security:spring-security-ldap") {
        exclude group: "org.springframework.ldap", module: "spring-ldap-core"
    }
}

compileGeneratedJava {
    options.warnings = false
    classpath += sourceSets.main.runtimeClasspath
}

clean {
    delete sourceSets.generated.java.srcDirs
}

idea {
    module {
        sourceDirs += file('build/generated-src')
    }
}


test {
    systemProperties = System.properties
}

